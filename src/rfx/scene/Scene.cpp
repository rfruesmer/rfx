#include "rfx/pch.h"
#include "rfx/scene/Scene.h"

using namespace rfx;
using namespace std;

// ---------------------------------------------------------------------------------------------------------------------

Scene::Scene(string id)
    : id(move(id)),
      lightsRootNode(make_shared<LightNode>(nullptr)) {}

// ---------------------------------------------------------------------------------------------------------------------

const string& Scene::getId() const
{
    return id;
}

// ---------------------------------------------------------------------------------------------------------------------

void Scene::compile()
{
    ranges::for_each(models,
        [](const ModelPtr& model) {
            model->compile();
        });

    lightsRootNode->compile();
}

// ---------------------------------------------------------------------------------------------------------------------

void Scene::add(ModelPtr model)
{
    models.push_back(move(model));
}

// ---------------------------------------------------------------------------------------------------------------------

const ModelPtr& Scene::getModel(size_t index)
{
    return models[index];
}

// ---------------------------------------------------------------------------------------------------------------------

size_t Scene::getModelCount() const
{
    return models.size();
}

// ---------------------------------------------------------------------------------------------------------------------

const vector<ModelPtr>& Scene::getModels() const
{
    return models;
}

// ---------------------------------------------------------------------------------------------------------------------

void Scene::addLight(const LightPtr& light)
{
    lights_.push_back(light);
}

// ---------------------------------------------------------------------------------------------------------------------

const LightPtr& Scene::getLight(size_t index) const
{
    return lights_[index];
}

// ---------------------------------------------------------------------------------------------------------------------

const vector<LightPtr>& Scene::getLights() const
{
    return lights_;
}

// ---------------------------------------------------------------------------------------------------------------------

uint32_t Scene::getLightCount() const
{
    return lights_.size();
}

// ---------------------------------------------------------------------------------------------------------------------

const LightNodePtr& Scene::getLightsRootNode() const
{
    return lightsRootNode;
}

// ---------------------------------------------------------------------------------------------------------------------
